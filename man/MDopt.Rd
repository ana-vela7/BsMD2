% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MDopt.R
\name{MDopt}
\alias{MDopt}
\title{Best Model Discrimination (MD) Follow-Up Experiments}
\usage{
MDopt(
  X,
  y,
  Xcand,
  nMod,
  p_mod,
  fac_mod,
  nFDes = 4,
  max_int = 3,
  g = 2,
  Iter = 20,
  nStart = 10,
  top = 10
)
}
\arguments{
\item{X}{Matrix. Design matrix of the initial experiment.}

\item{y}{Vector. Response vector of the initial experiment.}

\item{Xcand}{Matrix. Candidate runs to be chosen for the follow-up design.}

\item{nMod}{Integer. Number of competing models.}

\item{p_mod}{Vector. Posterior probabilities of the competing models.}

\item{fac_mod}{Matrix. Active factors in the competing models.}

\item{nFDes}{Integer. Number of runs to consider in the follow-up experiment.}

\item{max_int}{Integer. Maximum order of interactions in the models.}

\item{g}{Numeric. Variance inflation factor for active effects.}

\item{Iter}{Integer. Maximum number of iterations for each search.}

\item{nStart}{Integer. Number of random starting designs.}

\item{top}{Integer. Highest MD follow-up designs recorded.}
}
\value{
A list with all the input and output parameters.

\item{X}{Matrix. The design matrix.}

\item{y}{Vector. The response vector.}

\item{Xcand}{Matrix. Candidate runs to be chosen for the follow-up design.}

\item{Runs}{Integer. Number of runs.}

\item{Fac}{Integer. Number of factors.}

\item{nMod}{Integer. Number of competing models.}

\item{p_mod}{Vector. Posterior probabilities of the competing models.}

\item{fac_mod}{Matrix. Active factors in the competing models.}

\item{nFDes}{Integer. Number of runs to consider in the follow-up experiment.}

\item{max_int}{Integer. Maximum order of the interactions in the models.}

\item{g}{Numeric. Variance inflation factor for active effects.}

\item{Iter}{Integer. Maximum number of iterations for each search.}

\item{nStart}{Integer. Number of random starting designs.}

\item{top}{Integer. Highest MD follow-up designs recorded.}

\item{MD}{Data frame. Designs points and MD for top designs.}

\item{MDtop}{Vector. MD for top designs.}

\item{DEStop}{Data frame. Top design points.}
}
\description{
Best follow-up experiments based on the MD criterion are suggested to
discriminate between competing models.
}
\examples{
#Example 1
library(BsMD2)
data(BM93e3)
X <- as.matrix(BM93e3[1:16,c(1,2,4,6,9)]) #matriz de diseÃ±o inicial
y <- as.vector(BM93e3[1:16,10]) #vector de respuesta
p_mod <- c(0.2356,0.2356,0.2356,0.2356,0.0566) #probabilidad posterior de los 5 modelos
fac_mod <- matrix(c(2,1,1,1,1,3,3,2,2,2,4,4,3,4,3,0,0,0,0,4),nrow=5,
                  dimnames=list(1:5,c("f1","f2","f3","f4")))
Xcand <- matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
                  -1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,
                  -1,-1,1,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1,1,
                  -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
                  -1,1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,1,1,-1),
                nrow=16,dimnames=list(1:16,c("blk","f1","f2","f3","f4"))
)
injectionMolding <- MDopt(X = X, y = y, Xcand = Xcand, nMod = 5, p_mod = p_mod, fac_mod = fac_mod,
nStart = 25)

#Example 2
data(M96e2,package="BsMD2")
X <- as.matrix(cbind(blk = rep(-1,8), M96e2[c(25,2,19,12,13,22,7,32), 1:5]))
y <- M96e2[c(25,2,19,12,13,22,7,32), 6]
pp <- BsProb1(X = X[,2:6], y = y, p = .25, gamma = .4, max_int = 3, max_fac = 5, top = 32)
p <- pp@p_mod
facs <- pp@fac_mod
Xcand <- as.matrix(cbind(blk = rep(+1,32), M96e2[,1:5]))
#e2 <- MDopt(X = X, y = y, Xcand = Xcand, nMod = 32, p_mod = p, fac_mod = facs, g = .4,
#Iter = 10, nStart = 25, top = 5)
}
\references{
{
Meyer, R. D., Steinberg, D. M. and Box, G. E. P. (1996). "Follow-Up Designs to Resolve
Confounding in Multifactor Experiments (with discussion)". Technometrics, Vol. 38,
No. 4, pp. 303{-}332.

Box, G. E. P and R. D. Meyer (1993). "Finding the Active Factors in Fractionated
Screening Experiments". Journal of Quality Technology. Vol. 25. No. 2. pp. 94{–}105.

}
}
